<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "file:///home/nico/I-Ds/test/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.0.0" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Hypertext Transport Protocol (HTTP) Session Continuation Protocol</title>

<!-- Text Class Preamble -->
<style type="text/css">
div.toc {
margin: 2em 0em;
border-style: solid;
border-width: 2px 0px;
padding: 1em 0em;
}
div.tochead { font-size: x-large; font-weight: bold; }
div.lyxtoc-0 {
margin: 2em 0em 0em 0em;
font-size: xx-large;
font-weight: bold;
}
div.lyxtoc-1 {
margin: 1em 0em 0em 0em;
font-size: x-large;
font-weight: bold;
}
div.lyxtoc-2 {
margin: 0em 0em 0em 1em;
font-size: large;
font-weight: normal;
}
div.lyxtoc-3 { margin: 0em 0em 0em 0.5em; font-size: medium; }
div.lyxtoc-4 { margin: 0em 0em 0em 0.5em; }
div.lyxtoc-5 { margin: 0em 0em 0em 0.5em; }
div.lyxtoc-6 { margin: 0em 0em 0em 0.5em; }
a.tocentry {
text-decoration: none;
color: black;
}
a.tocentry:visited { color: black; }
a.tocarrow {
font-weight: bold;
text-decoration: none;
color: #909090;
}
a.tocarrow:visited { color: #C0C0C0; }
</style>

<!-- Preamble Snippets -->

<!-- Layout-provided Styles -->
<style type='text/css'>
h1.title {
font-size: x-large;
margin-bottom: 1ex;
text-align: center;

}
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
div.author {
font-size: large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.abstract {
font-size: small;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
margin-right: 3ex;
text-align: left;

}
div.abstract_label {
font-weight: bold;
font-size: large;
text-align: center;

}

div.abstract {
margin: 4ex;
}
div.abstract_item {
font-size: small;
padding-top: 1ex;
}
div.abstract_label {
font-weight: bold;
}
h2.section {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
h3.subsection {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
div.flex_docname {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_ipr {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_intendedstatus {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_titleabbrev {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_ietfarea {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_xml_rfckeyword {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_pi {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authororg {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authororgabbrev {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authoremailaddr {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_entityxref {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_embeddedbibxml {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_bibxml {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
</style>
</head>
<body>
<h1 class="title"><a id='magicparlabel-1' />
Hypertext Transport Protocol (HTTP) Session Continuation Protocol</h1>
<div class="standard"><a id='magicparlabel-2' />
<div class="flex_docname"><div class="plain_layout"><a id='magicparlabel-6' />
draft-williams-websec-session-continue-proto-00</div>
</div><div class="flex_ipr"><div class="plain_layout"><a id='magicparlabel-10' />
trust200902</div>
</div><div class="flex_intendedstatus"><div class="plain_layout"><a id='magicparlabel-14' />
std</div>
</div><div class="flex_titleabbrev"><div class="plain_layout"><a id='magicparlabel-18' />
HTTP Session Problem</div>
</div><div class="flex_ietfarea"><div class="plain_layout"><a id='magicparlabel-22' />
Security Area</div>
</div><div class="flex_xml_rfckeyword"><div class="plain_layout"><a id='magicparlabel-26' />
Internet-Draft</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-30' />
tocindent="no"</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-34' />
comments="yes"</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-38' />
inline="yes"</div>
</div></div>

<div class="author"><div class="author_item"><a id='magicparlabel-39' />
Nicolas Williams<div class="flex_authororg"><div class="plain_layout"><a id='magicparlabel-43' />
Cryptonector, LLC</div>
</div><div class="flex_authororgabbrev"><div class="plain_layout"><a id='magicparlabel-47' />
Cryptonector</div>
</div><div class="flex_authoremailaddr"><div class="plain_layout"><a id='magicparlabel-51' />
nico@cryptonector.com</div>
</div></div>
</div>

<div class="abstract"><div class="abstract_label">Abstract</div>
<div class="abstract_item"><a id='magicparlabel-52' />
One of the most often talked about problems in web security is &ldquo;cookies&rdquo;. Web cookies are a method of associating requests with &ldquo;sessions&rdquo; that may have been authenticated somehow. Cookies are a form of bearer token that leave much to be desired. This document proposes a session &ldquo;continuation&rdquo; protocol for HyperText Transport Protocol (HTTP).</div>
</div>
<div class="standard"><a id='magicparlabel-53' />
</div>
<div class='toc'><div class='tochead part_'>Table of Contents</div>

<div class='lyxtoc-1'><a href='#magicparlabel-54' class='tocentry'>1 Introduction</a> <a href='#magicparlabel-54' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-76' class='tocentry'>2 Session Keying</a> <a href='#magicparlabel-76' class='tocarrow'>&gt;</a>

<div class='lyxtoc-2'><a href='#magicparlabel-81' class='tocentry'>2.1 Mixing HTTP and HTTPS</a> <a href='#magicparlabel-81' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-2'><a href='#magicparlabel-83' class='tocentry'>2.2 Authenticated Session Keying</a> <a href='#magicparlabel-83' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-2'><a href='#magicparlabel-85' class='tocentry'>2.3 Unauthenticated Session Keying</a> <a href='#magicparlabel-85' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-88' class='tocentry'>3 Session Initiation</a> <a href='#magicparlabel-88' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-96' class='tocentry'>4 Unauthenticated to Authenticated Session Upgrade</a> <a href='#magicparlabel-96' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-97' class='tocentry'>5 Session Continuation</a> <a href='#magicparlabel-97' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-101' class='tocentry'>6 IANA Considerations</a> <a href='#magicparlabel-101' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-103' class='tocentry'>7 Security Considerations</a> <a href='#magicparlabel-103' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-105' class='tocentry'>8 Normative References</a> <a href='#magicparlabel-105' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-131' class='tocentry'>9 Informative References</a> <a href='#magicparlabel-131' class='tocarrow'>&gt;</a></div>
</div>

<h2 class="section"><span class="section_label">1</span> <a id='magicparlabel-54' />
<a id="sec_Introduction" />
Introduction</h2>
<div class="standard"><a id='magicparlabel-55' />
The motivation for this protocol is described in <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-59' />
I-D.williams-websec-session-continue-prob</div>
</div>.</div>

<div class="standard"><a id='magicparlabel-60' />
We define a protocol for cryptographic &ldquo;session continuation&rdquo; for HyperText Transport Protocol (HTTP) <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-64' />
RFC2616</div>
</div>. Session continuation is the act of binding an HTTP request to a &ldquo;session&rdquo;. A &ldquo;session&rdquo; consists of all the HTTP requests by a given user (possibly an authenticated user, or possibly an anonymous user). This protocol is a cryptographic protocol that aims to meet all the requirements given in <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-68' />
I-D.williams-websec-session-continue-prob</div>
</div>.</div>

<div class="standard"><a id='magicparlabel-69' />
The protocol consists of:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-70' />
a request header carrying a keyed Message Authentication Code (MAC) that prove possession of a shared session key (shared between the user and the server);</li>
<li class="itemize_item"><a id='magicparlabel-71' />
a response header advertising a default session scope to clients;</li>
<li class="itemize_item"><a id='magicparlabel-72' />
a session identification in the form of a URI;</li>
<li class="itemize_item"><a id='magicparlabel-73' />
optional server-side statelessness by storing state on the client-side, encrypted in a secret key known to the server;</li>
<li class="itemize_item"><a id='magicparlabel-74' />
a request header for requesting the establishment of a session;</li>
<li class="itemize_item"><a id='magicparlabel-75' />
a response header for indicating the establishment of a session, and including a session URI and any optional state to be repeated by the client.</li>
</ul>
<h2 class="section"><span class="section_label">2</span> <a id='magicparlabel-76' />
Session Keying</h2>
<div class="standard"><a id='magicparlabel-77' />
There are two methods for keying an HTTP session:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-78' />
session keys are output by HTTP authentication;</li>
<li class="itemize_item"><a id='magicparlabel-79' />
or session keys are asserted by the client;</li>
</ul>
<div class="standard"><a id='magicparlabel-80' />
For the key assertion method TLS with confidentiality protection is clearly REQUIRED for security. We've considered the possibility of using Diffie-Hellman key agreement or RSA key transport, but as that would duplicate functionality that is in TLS we consider that out of scope for the time being. (We could also use the TLS extractor to generate keys, but that would be an unnecessary complication and would provide very little additional value.)</div>
<h3 class="subsection"><span class="subsection_label">2.1</span> <a id='magicparlabel-81' />
Mixing HTTP and HTTPS</h3>
<div class="standard"><a id='magicparlabel-82' />
We expect that many sites will continute to mix HTTP and HTTPS for various reasons. To make this possible sessions will have two session keys: one for use over HTTPS, and the other for use over HTTP.</div>
<h3 class="subsection"><span class="subsection_label">2.2</span> <a id='magicparlabel-83' />
Authenticated Session Keying</h3>
<div class="standard"><a id='magicparlabel-84' />
When an HTTP client uses HTTP authentication, and the authentication mechanism used can establish a session key, then the client SHOULD request session initiation using a shared session key output by the HTTP authentication mechanism. The client MUST send the session initiation header concurrently with the last HTTP authentication message.</div>
<h3 class="subsection"><span class="subsection_label">2.3</span> <a id='magicparlabel-85' />
Unauthenticated Session Keying</h3>
<div class="standard"><a id='magicparlabel-86' />
Sessions for unauthenticated users may appear to make little sense at first. This is useful, for example, and just as web cookies are, for tracking &ldquo;shopping carts&rdquo; when a user is window shopping, so to speak.</div>

<div class="standard"><a id='magicparlabel-87' />
For unauthenticated session initiation the client merely requests the creation of a session with an asserted session key, for lack of a better choice.</div>
<h2 class="section"><span class="section_label">3</span> <a id='magicparlabel-88' />
Session Initiation</h2>
<div class="standard"><a id='magicparlabel-89' />
Sessions are initiated either as an outcome of HTTP authentication (see RFC2617, or in spite of the absence of any HTTP authentication; sessions are always initiated by the client.</div>

<div class="standard"><a id='magicparlabel-90' />
Servers that support sessions will respond by creating a session and returning a session ID URI.</div>

<div class="standard"><a id='magicparlabel-91' />
For unauthenticated session initiation the client includes a &ldquo;Session-Init&rdquo; header in its request. This header's value will consist of a base64-encoding of a randomly-generated octet string of at least 64 bits and up to 256 bits, and a boolean indicating whether the session will also operate without TLS. The server's response, if it agrees to session initiation, will contain a &ldquo;Session-Init&rdquo; header with a session identifier.</div>

<div class="standard"><a id='magicparlabel-92' />
If the server accepts then the client and server will generate a session key as described in [...].</div>

<div class="standard"><a id='magicparlabel-93' />
If the request is sent over HTTPS (TLS) then the client may allow the use of the session without TLS, in which case a second session key will be generated for use without TLS as described in [...].</div>

<div class="standard"><a id='magicparlabel-94' />
[XXX Add a channel binding type negotiation, or perhaps say: tls-server-end-point if a server cert is used, else tls-unique.]</div>

<div class="standard"><a id='magicparlabel-95' />
[XXX Add MAC and KDF algorithm negotiation.]</div>
<h2 class="section"><span class="section_label">4</span> <a id='magicparlabel-96' />
Unauthenticated to Authenticated Session Upgrade</h2>
<h2 class="section"><span class="section_label">5</span> <a id='magicparlabel-97' />
Session Continuation</h2>
<div class="standard"><a id='magicparlabel-98' />
Once a session is established the client binds requests to sessions as described here.</div>

<div class="standard"><a id='magicparlabel-99' />
There are two cases: HTTPS and HTTP.</div>

<div class="standard"><a id='magicparlabel-100' />
For the HTTPS case the client adds a &ldquo;Session&rdquo; header to its requests with the following content: the session identifier assigned by the server, a nonce generated by the client, and a MAC of the nonce and the TLS channel bindings.</div>
<h2 class="section"><span class="section_label">6</span> <a id='magicparlabel-101' />
<a id="sec_IANA_Considerations" />
IANA Considerations</h2>
<div class="standard"><a id='magicparlabel-102' />
This document creates a number of new HTTP request and response headers. These headers will need to be added to the HTTP header registry: &lt;TBD&gt;.</div>
<h2 class="section"><span class="section_label">7</span> <a id='magicparlabel-103' />
<a id="sec_Security_Considerations" />
Security Considerations</h2>
<div class="standard"><a id='magicparlabel-104' />
[...]</div>
<h2 class="section"><span class="section_label">8</span> <a id='magicparlabel-105' />
Normative References</h2>
<div class="standard"><a id='magicparlabel-106' />
<div class="flex_embeddedbibxml"><div class="plain_layout"><a id='magicparlabel-110' />
&lt;reference anchor='I-D.williams-websec-session-continue-prob'&gt; &lt;front&gt; &lt;title&gt;Hypertext Transport Protocol (HTTP) Session Continuation: Problem Statement&lt;/title&gt; &lt;author initials='N.' surname='Williams' fullname='Nicolas Williams'&gt; &lt;organization /&gt; &lt;/author&gt; &lt;date month='January' day='1' year='2013' /&gt; &lt;abstract&gt;&lt;t&gt;Abstract One of the most often talked about problems in web security is “cookies”. Web cookies are a method of associating requests with “sessions” that may have been authenticated somehow. Cookies are a form of bearer token that leave much to be desired. This document describes the session “continuation” problem for the HyperText Transport Protocol (HTTP).&lt;/t&gt;&lt;/abstract&gt; &lt;/front&gt; &lt;seriesInfo name='Internet-Draft' value='draft-williams-websec-session-continue-prob-00' /&gt; &lt;format type='TXT' target='http://www.ietf.org/internet-drafts/draft-draft-williams-websec-session-continue-prob-00.txt' /&gt; &lt;/reference&gt; </div>
</div></div>

<div class="standard"><a id='magicparlabel-111' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-115' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2616.xml">rfc2616</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-116' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-120' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5246.xml">rfc5246</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-121' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-125' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5056.xml">rfc5056</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-126' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-130' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5929.xml">rfc5929</a></div>
</div></div>
<h2 class="section"><span class="section_label">9</span> <a id='magicparlabel-131' />
<a id="sec_Normative_References" />
Informative References</h2>
<div class="standard"><a id='magicparlabel-132' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-136' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2617.xml">rfc2617</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-137' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-141' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5849.xml">rfc5849</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-142' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-146' />
<a href="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-oauth-v2.xml">I-D.ietf-oauth-v2</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-147' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-151' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.4559.xml">rfc4559</a></div>
</div></div>
</body>
</html>
