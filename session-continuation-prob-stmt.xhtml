<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "file:///home/nico/I-Ds/test/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="GENERATOR" content="LyX 2.0.0" />
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Hypertext Transport Protocol (HTTP) Session Continuation: Problem Statement</title>

<!-- Text Class Preamble -->
<style type="text/css">
div.toc {
margin: 2em 0em;
border-style: solid;
border-width: 2px 0px;
padding: 1em 0em;
}
div.tochead { font-size: x-large; font-weight: bold; }
div.lyxtoc-0 {
margin: 2em 0em 0em 0em;
font-size: xx-large;
font-weight: bold;
}
div.lyxtoc-1 {
margin: 1em 0em 0em 0em;
font-size: x-large;
font-weight: bold;
}
div.lyxtoc-2 {
margin: 0em 0em 0em 1em;
font-size: large;
font-weight: normal;
}
div.lyxtoc-3 { margin: 0em 0em 0em 0.5em; font-size: medium; }
div.lyxtoc-4 { margin: 0em 0em 0em 0.5em; }
div.lyxtoc-5 { margin: 0em 0em 0em 0.5em; }
div.lyxtoc-6 { margin: 0em 0em 0em 0.5em; }
a.tocentry {
text-decoration: none;
color: black;
}
a.tocentry:visited { color: black; }
a.tocarrow {
font-weight: bold;
text-decoration: none;
color: #909090;
}
a.tocarrow:visited { color: #C0C0C0; }
</style>

<!-- Preamble Snippets -->

<!-- Layout-provided Styles -->
<style type='text/css'>
h1.title {
font-size: x-large;
margin-bottom: 1ex;
text-align: center;

}
div.standard {
text-align: left;

}
div.plain_layout {
text-align: left;

}
div.author {
font-size: large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: center;

}
div.abstract {
font-size: small;
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
margin-right: 3ex;
text-align: left;

}
div.abstract_label {
font-weight: bold;
font-size: large;
text-align: center;

}

div.abstract {
margin: 4ex;
}
div.abstract_item {
font-size: small;
padding-top: 1ex;
}
div.abstract_label {
font-weight: bold;
}
h2.section {
font-weight: bold;
font-size: x-large;
margin-top: 1.3ex;
margin-bottom: 0.7ex;
text-align: left;

}
h3.subsection {
font-weight: bold;
font-size: large;
margin-top: 0.9ex;
margin-bottom: 0.5ex;
text-align: left;

}
ul.itemize {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
ol.enumerate {
margin-top: 0.7ex;
margin-bottom: 0.7ex;
margin-left: 3ex;
text-align: left;

}
div.revisionremark {
text-align: left;

}
div.flex_docname {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_ipr {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_intendedstatus {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_titleabbrev {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_ietfarea {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_xml_rfckeyword {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_pi {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authororg {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authororgabbrev {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_authoremailaddr {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_entityxref {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_bibxml {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
div.flex_embeddedbibxml {
font-family: serif;
font-weight: normal;
font-style: normal;
font-variant: normal;
font-size: medium;
}
</style>
</head>
<body>
<h1 class="title"><a id='magicparlabel-1' />
Hypertext Transport Protocol (HTTP) Session Continuation: Problem Statement</h1>
<div class="standard"><a id='magicparlabel-2' />
<div class="flex_docname"><div class="plain_layout"><a id='magicparlabel-6' />
draft-williams-websec-session-continue-prob-00</div>
</div><div class="flex_ipr"><div class="plain_layout"><a id='magicparlabel-10' />
trust200902</div>
</div><div class="flex_intendedstatus"><div class="plain_layout"><a id='magicparlabel-14' />
info</div>
</div><div class="flex_titleabbrev"><div class="plain_layout"><a id='magicparlabel-18' />
HTTP Session Problem</div>
</div><div class="flex_ietfarea"><div class="plain_layout"><a id='magicparlabel-22' />
Security Area</div>
</div><div class="flex_xml_rfckeyword"><div class="plain_layout"><a id='magicparlabel-26' />
Internet-Draft</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-30' />
tocindent="no"</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-34' />
comments="yes"</div>
</div><div class="flex_pi"><div class="plain_layout"><a id='magicparlabel-38' />
inline="yes"</div>
</div></div>

<div class="author"><div class="author_item"><a id='magicparlabel-39' />
Nicolas Williams<div class="flex_authororg"><div class="plain_layout"><a id='magicparlabel-43' />
Cryptonector, LLC</div>
</div><div class="flex_authororgabbrev"><div class="plain_layout"><a id='magicparlabel-47' />
Cryptonector</div>
</div><div class="flex_authoremailaddr"><div class="plain_layout"><a id='magicparlabel-51' />
nico@cryptonector.com</div>
</div></div>
</div>

<div class="abstract"><div class="abstract_label">Abstract</div>
<div class="abstract_item"><a id='magicparlabel-52' />
One of the most often talked about problems in web security is &ldquo;cookies&rdquo;. Web cookies are a method of associating requests with &ldquo;sessions&rdquo; that may have been authenticated somehow. Cookies are a form of bearer token that leave much to be desired. This document describes the session &ldquo;continuation&rdquo; problem for the HyperText Transport Protocol (HTTP).</div>
</div>
<div class="standard"><a id='magicparlabel-53' />
</div>
<div class='toc'><div class='tochead part_'>Table of Contents</div>

<div class='lyxtoc-1'><a href='#magicparlabel-54' class='tocentry'>1 Introduction</a> <a href='#magicparlabel-54' class='tocarrow'>&gt;</a>

<div class='lyxtoc-2'><a href='#magicparlabel-58' class='tocentry'>1.1 Motivation</a> <a href='#magicparlabel-58' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-2'><a href='#magicparlabel-79' class='tocentry'>1.2 Conventions used in this document</a> <a href='#magicparlabel-79' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-85' class='tocentry'>2 Requirements</a> <a href='#magicparlabel-85' class='tocarrow'>&gt;</a>

<div class='lyxtoc-2'><a href='#magicparlabel-103' class='tocentry'>2.1 Statelessness</a> <a href='#magicparlabel-103' class='tocarrow'>&gt;</a></div>
</div>

<div class='lyxtoc-1'><a href='#magicparlabel-109' class='tocentry'>3 IANA Considerations</a> <a href='#magicparlabel-109' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-111' class='tocentry'>4 Security Considerations</a> <a href='#magicparlabel-111' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-119' class='tocentry'>5 Normative References</a> <a href='#magicparlabel-119' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-125' class='tocentry'>6 Informative References</a> <a href='#magicparlabel-125' class='tocarrow'>&gt;</a></div>

<div class='lyxtoc-1'><a href='#magicparlabel-166' class='tocentry'>7 Acknowledgements</a> <a href='#magicparlabel-166' class='tocarrow'>&gt;</a></div>
</div>

<h2 class="section"><span class="section_label">1</span> <a id='magicparlabel-54' />
<a id="sec_Introduction" />
Introduction</h2>
<div class="standard"><a id='magicparlabel-55' />
Today most web applications use &ldquo;cookies&rdquo; to associate HTTP requests with &ldquo;sessions&rdquo;. A &ldquo;session&rdquo; is a set of related HTTP requests (and responses), where the relation is to some request(s) that created the session. Some sessions are created by the act of authenticating a user, in which case the primary goal of &ldquo;sessions&rdquo; is to avoid having to re-authenticate the user on every request. Other times a session is created when a request is received that is not associated with any session, in which case the primary purpose of &ldquo;sessions&rdquo; may be to provide a pseudonymous identifier for an otherwise anonymous user. We call the mechanisms by which requests are strung into sessions &ldquo;session continuation&rdquo;.</div>

<div class="standard"><a id='magicparlabel-56' />
&ldquo;Cookies&rdquo; are server-assigned bearer tokens &ndash; nothing more, nothing less. A bearer token is an octet blob which can be presented as-is, possibly repeatedly, to authenticate a user to some party; mere possession of the bearer token is sufficient to act on the user's behalf to at least one service. As such they are susceptible to theft via passive attacks (eavesdropping) if not protected in some other way (e.g., by using TLS), or via active attacks such as BEAST and CRIME [http://www.xors.me/?attachment_id=3727], as well as to leakage in various ways [XXX expand].</div>

<div class="standard"><a id='magicparlabel-57' />
We would like a session continuation mechanism to replace (or augment) cookies that has better security semantics. In particular we would like a system that is not susceptible to theft via active attacks like BEAST and CRIME. We believe that such a scheme should use cryptographic algorithms and cryptographic session keys, and should be amenable to being keyed by HTTP- and web-authentication mechanisms. A new session continuation mechanism should be suitable for use in web and non-web HTTP applications, and should work even for unauthenticated sessions.</div>
<h3 class="subsection"><span class="subsection_label">1.1</span> <a id='magicparlabel-58' />
Motivation</h3>
<div class="standard"><a id='magicparlabel-59' />
The motivation for this document and the related session continuation protocol <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-63' />
I-D.draft-williams-websec-session-continue-proto</div>
</div> document is as follows. We want:</div>

<ul class="itemize"><li class="itemize_item"><a id='magicparlabel-64' />
A variable authentication token instead of web cookies, for resistance to BEAST, CRIME, and other adaptive chosen plaintext active attacks on TLS.</li>
<li class="itemize_item"><a id='magicparlabel-65' />
The ability to explicitly logout and destroy all session state even if the session has been compromised, assuming there is no Man In The Browser (MITB).</li>
<li class="itemize_item"><a id='magicparlabel-66' />
The ability to manage sessions using an explicit session name.</li>
<li class="itemize_item"><a id='magicparlabel-67' />
The ability to negotiate replay protection.</li>
<li class="itemize_item"><a id='magicparlabel-68' />
Cryptographic binding (&ldquo;channel binding&rdquo; <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-72' />
RFC5056</div>
</div>) to the lower transport layer (TLS, where available).</li>
<li class="itemize_item"><a id='magicparlabel-73' />
Cryptographic binding to the user authentication mechanisms (where the authentication mechanism can export a secret value).</li>
<li class="itemize_item"><a id='magicparlabel-74' />
The ability to use HTTP/Negotiate <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-78' />
RFC4559</div>
</div> in such a way that a) new HTTP(S) connections need not result in re-authentication, b) does not strobgly bind requests in a single HTTP connection to the HTTP/Negotiate authentication that precedes them.</li>
</ul>
<h3 class="subsection"><span class="subsection_label">1.2</span> <a id='magicparlabel-79' />
Conventions used in this document</h3>
<div class="standard"><a id='magicparlabel-80' />
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <div class="flex_entityxref"><div class="plain_layout"><a id='magicparlabel-84' />
RFC2119</div>
</div>.</div>
<h2 class="section"><span class="section_label">2</span> <a id='magicparlabel-85' />
Requirements</h2>
<div class="standard"><a id='magicparlabel-86' />
Any session continuation scheme to replace (or augment) cookies must provide the following functionality:</div>

<ol class="enumerate"><li class="enumerate_item"><a id='magicparlabel-87' />
Support for authenticated and unauthenticated sessions alike.</li>
<li class="enumerate_item"><a id='magicparlabel-88' />
Support for http: and https: both.</li>
<li class="enumerate_item"><a id='magicparlabel-89' />
Session continuation must be possible to implement without keeping state on the server side (see below), and it must be possible to keep some state on the server and some on the client.</li>
<li class="enumerate_item"><a id='magicparlabel-90' />
Resistance to active attacks on https.</li>
<li class="enumerate_item"><a id='magicparlabel-91' />
Session continuation must be expressed via HTTP headers.</li>
<li class="enumerate_item"><a id='magicparlabel-92' />
Session continuation header values must be cryptographically difficult for attackers to spoof, and servers must be able to validate these values.</li>
<li class="enumerate_item"><a id='magicparlabel-93' />
Session continuation header values used with TLS must be cryptographically distinct from those used without TLS such that no such values taken from HTTP requests sent without TLS can be used in HTTP requests with TLS.</li>
<li class="enumerate_item"><a id='magicparlabel-94' />
Session continuation must provide protection against man-in-the-middle (MITM) attacks at least when using TLS.</li>
<li class="enumerate_item"><a id='magicparlabel-95' />
Must support explicit session termination (&ldquo;logout&rdquo;), initiated by either party, client or server. Once a session is logged out there should be no way to use it again, even if any session keys are compromised. Note that this is not a deployment requirement, just a protocol requirement; a fully stateless deployment may not be able to implement faithful logout.</li>
<li class="enumerate_item"><a id='magicparlabel-96' />
Must work across all types of proxies. Proxies that can modify the plaintext HTTP requests and responses can (but should not) interfere with any session continuation protocol.</li>
<li class="enumerate_item"><a id='magicparlabel-97' />
Sessions should be tied to &ldquo;origins&rdquo;; multi-origin sessions (sharing sessions across servers) are allowed, but there are user interface considerations.</li>
</ol>
<div class="revisionremark"><a id='magicparlabel-98' />
Can you move a session from one server to another? No, probably not. Servers can share sessions, so we need to at least be able to scope sessions to sets of servers or DNS sub-domains. This appears to require that sessions have names. Once we have proper session continuation we may well end up needing a mechanism by which to authenticate to a service as a user of a given session on a foreign service that is &ldquo;friends&rdquo; with the first.</div>

<div class="standard"><a id='magicparlabel-99' />
Recommendations:</div>

<ol class="enumerate"><li class="enumerate_item"><a id='magicparlabel-100' />
Session continuation SHOULD use proof-of-possession of secret session key(s).</li>
<li class="enumerate_item"><a id='magicparlabel-101' />
Session continuation header values SHOULD include a cryptographically-secure value (indistinguishable from random) that can be validated by the server and is hard for attackers to guess.</li>
<li class="enumerate_item"><a id='magicparlabel-102' />
Session continuation header values should be salted with a nonce to defeate BEAST- and CRIME-style active attacks.</li>
</ol>
<h3 class="subsection"><span class="subsection_label">2.1</span> <a id='magicparlabel-103' />
<a id="sub_Statelessness" />
Statelessness</h3>
<div class="standard"><a id='magicparlabel-104' />
Session continuation protocols for HTTP MUST allow for stateless implementation on the server side, at least when TLS is used. This generally means that any state must be encrypted and encoded into a session state cookie that is re-sent by the client to the server on every request. The server, of course, must be the one to assign such state, and it must use an encryption key known only by the server.</div>

<div class="standard"><a id='magicparlabel-105' />
Server-side statelessness is NOT REQUIRED in actual deployments, but the ability to implement session continuation in a stateless fashion on the server side is REQUIRED.</div>

<div class="standard"><a id='magicparlabel-106' />
Note that statelessness implies that there is no way to implement replay protection. In the case of session continuation with TLS this is not a concern because TLS itself protects against replays. But when session continuation is used without TLS then statelessness really does mean that there can be no replay protection (of course, this is also thus with web cookies). Therefore servers that require replay protection must either require the use of TLS or must use stateful sessions.</div>

<div class="standard"><a id='magicparlabel-107' />
Note also that statelessness makes session logout a no-op on the server-side, which means that a compromised session can continue to be used even after a client attempts to logout. A session continuation protocol MUST allow for storing some state on the server, and some on the client, allowing deployments where the only state stored is the existence of a session.</div>

<div class="standard"><a id='magicparlabel-108' />
Probabilistic data structures (e.g., Bloom filters) MAY be used to record logouts. This may require the ability to expire and refresh sessions to render the logout system scalable. In other words, HTTP responses MUST be allowed to replace session server state stored on the client side.</div>
<h2 class="section"><span class="section_label">3</span> <a id='magicparlabel-109' />
<a id="sec_IANA_Considerations" />
IANA Considerations</h2>
<div class="standard"><a id='magicparlabel-110' />
This document does not specify any protocols and has no IANA considerations.</div>
<h2 class="section"><span class="section_label">4</span> <a id='magicparlabel-111' />
<a id="sec_Security_Considerations" />
Security Considerations</h2>
<div class="standard"><a id='magicparlabel-112' />
This document does not specify any protocols and is Informational. There are, however, few security considerations to document here.</div>

<div class="standard"><a id='magicparlabel-113' />
We seek to improve security on the web (as well as for non-web HTTP applications) by:</div>

<ol class="enumerate"><li class="enumerate_item"><a id='magicparlabel-114' />
reducing the need for expensive HTTP authentication exchanges (e.g., HTTP/Negotiate), thereby removing an obstacle to their use;</li>
<li class="enumerate_item"><a id='magicparlabel-115' />
reducing exposure to session credentials theft via attacks on TLS such as BEAST and CRIME;</li>
<li class="enumerate_item"><a id='magicparlabel-116' />
reducing exposure to session credentials theft when not using TLS;</li>
<li class="enumerate_item"><a id='magicparlabel-117' />
introducing a replacement for cookies that will give browsers a chance to pursue better security policies.</li>
</ol>
<div class="standard"><a id='magicparlabel-118' />
As discussed in <a href="#sub_Statelessness">2.1</a>, there is a security consideration regarding session continuation without TLS and with server-side statelessness: there can be no replay protection in this case. However, this is not a loss of security relative to web cookies. Applications must use TLS if they require integrity protection.</div>
<h2 class="section"><span class="section_label">5</span> <a id='magicparlabel-119' />
Normative References</h2>
<div class="standard"><a id='magicparlabel-120' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-124' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">rfc2119</a></div>
</div></div>
<h2 class="section"><span class="section_label">6</span> <a id='magicparlabel-125' />
<a id="sec_Normative_References" />
Informative References</h2>
<div class="standard"><a id='magicparlabel-126' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-130' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2616.xml">rfc2616</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-131' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-135' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2617.xml">rfc2617</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-136' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-140' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5246.xml">rfc5246</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-141' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-145' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5056.xml">rfc5056</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-146' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-150' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5929.xml">rfc5929</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-151' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-155' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5849.xml">rfc5849</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-156' />
<div class="flex_bibxml"><div class="plain_layout"><a id='magicparlabel-160' />
<a href="http://xml.resource.org/public/rfc/bibxml/reference.RFC.4559.xml">rfc4559</a></div>
</div></div>

<div class="standard"><a id='magicparlabel-161' />
<div class="flex_embeddedbibxml"><div class="plain_layout"><a id='magicparlabel-165' />
&lt;reference anchor='I-D.draft-williams-websec-session-continue-proto'&gt; &lt;front&gt; &lt;title&gt;Hypertext Transport Protocol (HTTP) Session Continuation Protocol&lt;/title&gt; &lt;author initials='N.' surname='Williams' fullname='Nicolas Williams'&gt; &lt;organization /&gt; &lt;/author&gt; &lt;date month='January' day='1' year='2013' /&gt; &lt;abstract&gt;&lt;t&gt;Abstract One of the most often talked about problems in web security is “cookies”. Web cookies are a method of associating requests with “sessions” that may have been authenticated somehow. Cookies are a form of bearer token that leave much to be desired. This document proposes a session “continuation” protocol for HyperText Transport Protocol (HTTP).&lt;/t&gt;&lt;/abstract&gt; &lt;/front&gt; &lt;seriesInfo name='Internet-Draft' value='draft-williams-websec-session-continue-proto-00' /&gt; &lt;format type='TXT' target='http://www.ietf.org/internet-drafts/draft-draft-williams-websec-session-continue-proto-00.txt' /&gt; &lt;/reference&gt; </div>
</div></div>
<h2 class="section"><span class="section_label">7</span> <a id='magicparlabel-166' />
Acknowledgements</h2>
<div class="standard"><a id='magicparlabel-167' />
The author thanks Yaron Sheffer, Yoav Nir, and Phillip Hallam-Baker, all of whom are practically co-authors, and invited to be listed as such. The term &ldquo;session continuation&rdquo; is Phillip's. The motivation, requirements and recommendations text is a group effort.</div>
</body>
</html>
